<!DOCTYPE HTML>
<html>

<head>
	<title>Patching</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=1096">
	<link rel="stylesheet" href="assets/css/main.css" />
	<link rel="shortcut icon" type="image/jpg" href="favicon.ico" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/charts.css/dist/charts.min.css">
	<script>
		(function (i, s, o, g, r, a, m) {
			i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
				(i[r].q = i[r].q || []).push(arguments)
			}, i[r].l = 1 * new Date(); a = s.createElement(o),
				m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
		ga('create', 'UA-89797207-1', 'auto');
		ga('send', 'pageview');
	</script>
	<script async="" src="./Horizontal Bar Chart_files/analytics.js"></script>
	<script src="./Horizontal Bar Chart_files/Chart.bundle.js"></script>
	<script src="./Horizontal Bar Chart_files/utils.js"></script>
	<style>
		canvas {
			-moz-user-select: none;
			-webkit-user-select: none;
			-ms-user-select: none;
		}
	</style>

	<meta property="og:url" content="https://model-patching.github.io/" />
	<meta property="og:type" content="website" />
	<meta property="og:title" content="Patching open-vocabulary models by interpolating weights" />
	<meta property="og:description" content="Patching open-vocabulary models by interpolating weights" />


</head>

<body id="top">


	<!-- Main -->
	<div id="main"
		style="padding-bottom:1em; padding-top: 5em; width: 74em; max-width: 74em; margin-left: auto; margin-right: auto;">
		<section id="four">

			<h1 style="text-align: center; margin-bottom: 0;">
				<font color="4e79a7">Patching open-vocabulary models by interpolating weights</font>
			</h1>
			<!-- <h2 style="text-align: center;">Learning Interaction Strategies for Articulated Object Part Discovery</h2> -->
			<!-- <h3 style="text-align: center;">International Conference on Computer Vision (ICCV) 2021</h3> -->

			<span class="image right"
				style="max-width: 50%; margin-top: 2.5em; margin-bottom: 1.0em; border: 2px solid #415161;">
				<img src="images/diagram.png" alt="" />
			</span>

			<p align="justify">
				<br>
				While open-vocabulary models like CLIP achieve high accuracy across many
				image classification tasks, there are still settings where their zero-shot performance
				is far from optimal. We study model patching, where the goal is to improve
				accuracy on specific tasks (i.e., patching tasks) without degrading accuracy on
				tasks where performance is already adequate (i.e., supported tasks). Given a
				task to be patched, we first fine-tune without introducing new parameters, then
				interpolate the fine-tuned model weights with the model weights before fine-tuning.
				We explore model patching on nine tasks where zero-shot CLIP performs poorly,
				observing that patching increases accuracy by 15 to 60 percentage points while
				preserving accuracy on ImageNet within one percentage point of the zero-shot
				model. Additionally, we find that patching is more effective for larger models,
				demonstrate that a single model can be patched on multiple tasks, and identify
				cases of broad transfer, where patching on one task can increase accuracy on other
				tasks even when the classes are not shared. Finally, we investigate applications
				beyond standard benchmarks, including a patch which makes CLIP less susceptible
				to typographic attacks. Our findings demonstrate that it is possible to expand
				the set of tasks on which open-vocabulary models achieve high accuracy without
				re-training them from scratch.
				<br>
			</p>

			<hr / style="margin-top: 1em">

			<h3>Patching interactive demo!</h3>

			<!-- <span class="image right" style="max-width: 40%; margin-top: 0.5em; margin-bottom: 0; border: 2px solid #415161;"> -->

			<!-- <img src="http://vignette1.wikia.nocookie.net/seraphina/images/b/b2/Dragonseraphina.jpg/revision/latest?cb=20160103194957" height="200" width="200" alt="dragon"> -->
			<!-- <script src="assets/js/jquery.min.js"></script>
							<script src="assets/js/click_handling.js"></script> -->

			<p>
				Explore predictions for both a supported task (e.g., CIFAR-10) and a patching task (e.g., MNIST), by
				setting an interpolation factor &alpha; between 0 and 1.
				When &alpha; = 0, we have the model &theta;<sub>0</sub>, which is the original open-vocabulary model
				(i.e., CLIP ViT-B/32).
				When &alpha; = 1, we have the model &theta;<sub>1</sub>, which is fully fine-tuned on MNIST.
				<br>
				<!-- <strong style="text-decoration: underline;">Select an image from the following drop down list:</strong> -->
			</p>
			<div class="custom-select"
				style="margin-top: 0.5em; margin-bottom: 0; display: block; margin-left: auto; margin-right: auto; width:400px; text-align-last:center; ">

				<div>&theta;<sub>patch</sub> = (1 - &alpha;) * &theta;<sub>0</sub> + &alpha; * &theta;<sub>1</sub>,
					where</div>

				<span id="updatea"></span> <input type="range" min="0" max="100" value="0" id="t0" class="slider1"
					onchange="updateT0Input(this.value);">
				<p>&alpha; = <span id="demo1"></span></p>
				<script>
					function updateT0Input(t0) {
						document.getElementById("updatea").value = t0;
					}

					var slider1 = document.getElementById("t0");
					var output1 = document.getElementById("demo1");
					output1.innerHTML = slider1.value;

					slider1.oninput = function () {
						output1.innerHTML = this.value / 100.;
					}
				</script>

				<div id="container" style="width: 75%;"><iframe class="chartjs-hidden-iframe" tabindex="-1"
						style="display: block; overflow: hidden; border: 0px; margin: 0px; inset: 0px; height: 100%; width: 100%; position: absolute; pointer-events: none; z-index: -1;"
						src="./Horizontal Bar Chart_files/saved_resource.html"></iframe>
					<canvas id="canvas" width="1038" height="1038"
						style="display: block; height: 519px; width: 519px;"></canvas>
				</div>

				<script>
					function updateT0Input(t0) {
						document.getElementById("updatea").value = t0;
					}

					var slider1 = document.getElementById("t0");
					var output1 = document.getElementById("demo1");
					output1.innerHTML = slider1.value;

					slider1.oninput = function () {
						output1.innerHTML = this.value / 100.;
					}

					var MNIST = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"];
					var CIFAR10 = ["airplane", "automobile", "bird", "cat", "deer", "dog", "frog", "horse", "ship", "truck"];
					var color = Chart.helpers.color;
					var horizontalBarChartData = {
						labels: CIFAR10,
						datasets: [{
							label: 'Prediction: ',
							backgroundColor: color(window.chartColors.yellow).alpha(0.5).rgbString(),
							borderColor: window.chartColors.yellow,
							borderWidth: 1,
							data: [
								0.05,
								0.05,
								0.05,
								0.05,
								0.05,
								0.05,
								0.05,
								0.05,
								0.05,
								0.05,
							]
						}]

					};

					window.onload = function () {
						var ctx = document.getElementById("canvas").getContext("2d");
						window.myHorizontalBar = new Chart(ctx, {
							type: 'horizontalBar',
							data: horizontalBarChartData,
							options: {
								// Elements options apply to all of the options unless overridden in a dataset
								// In this case, we are setting the border of each horizontal bar to be 2px wide
								elements: {
									rectangle: {
										borderWidth: 2,
									}
								},
								responsive: true,
								legend: {
									display: false,
									position: 'right',
								},
								title: {
									display: false,
									text: 'Predictions'
								},
								scales: {
									xAxes: [{
										display: true,
										ticks: {
											min: 0, // minimum value
											max: 1,
											stepSize: 0.5 // maximum value
										}
									}]
								}
							}
						});

					};

					document.getElementById('t0').addEventListener('input', function () {
						key = document.getElementById('t0').value;
						var zero = Math.random() < 0.2 ? true : false;
						horizontalBarChartData.datasets.forEach(function (dataset) {
							dataset.data = dataset.data.map(function () {
								return key / 100.;
							});

						});
						window.myHorizontalBar.update();
					});

					var colorNames = Object.keys(window.chartColors);

				</script>

			</div>

			<!-- <hr/ style="margin-top: 1em">
						<h3>Highlights</h3>

						<section>
							<div class="box alt" style="margin-bottom: 0em;">

								<div class="row 50% uniform" style="width: 100%;">
									<div class="3u" style="margin-top: -5em; font-size: 0.7em; line-height: 1.5em; text-align: center;"><a href="https://ai.googleblog.com/2019/03/unifying-physics-and-deep-learning-with.html"><span class="image fit" style="margin-bottom: 0.5em;"><img src="images/logo-GoogleAI.png" alt="" style="height: 19em; width: auto;" /></span></a></div>
									<div class="3u" style="margin-left: 3em; margin-top: 1.6em; font-size: 0.7em; line-height: 1.5em; text-align: center;"><a href="https://www.nytimes.com/2019/03/26/technology/google-robotics-lab.html"><span class="image fit" style="margin-bottom: 0.5em;"><img src="images/logo-nyt.jpg" alt="" style="height: 6em; width: auto;" /></span></a></div>
									<div class="3u" style="margin-left: 6em; margin-top: 2.6em; font-size: 0.7em; line-height: 1.5em; text-align: center;"><a href="https://spectrum.ieee.org/automaton/robotics/artificial-intelligence/google-teaches-robot-to-toss-bananas-better-than-you-do"><span class="image fit" style="margin-bottom: 0.5em;"><img src="images/logo-ieeespectrum.png" alt="" style="height: 3em; width: auto;" /></span></a></div>

								</div>
							</div>
						</section> -->

			<hr style="margin-top: 0em;">
			<h3>Paper (TODO)</h3>

			<!-- <hr/> -->
			<p style="margin-bottom: 1em;">Latest version: <a href="https://arxiv.org/abs/2105.01047">arXiv:2105.01047
					[cs.CV]</a> or <a href="paper.pdf">here</a></p>

			<div class="12u$"><a href="https://arxiv.org/pdf/2105.01047.pdf"><span class="image fit"
						style="border: 1px solid; border-color: #888888;"><img src="images/paper-thumbnail.jpg"
							alt="" /></span></a></div>

			<!-- <p style="margin-bottom: 1em;">CAD Models for the 3D printed parts can be found: <a
					href="CAD_gripper.zip">here</a></p> -->

			<hr>
			<h3>Team</h3>

			<section>
				<div class="box alt" style="margin-bottom: 1em;">
					<div class="row 50% uniform" style="width: 90%;">
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="https://gabrielilharco.com/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/gabriel-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Gabriel Ilharco *<sup>1</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="https://mitchellnw.github.io/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/mitchell-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Mitchell Wortsman *<sup>1</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="http://sagadre.github.io/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/samir-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Samir Yitzhak Gadre *<sup>2</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="http://shurans.github.io/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/shuran-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Shuran Song <sup>2</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="https://homes.cs.washington.edu/~hannaneh/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/hannaneh-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Hannaneh Hajishirzi <sup>1</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="https://simonster.com/"><span class="image fit" style="margin-bottom: 0.5em;"><img
										src="images/simon-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Simon Kornblith <sup>3</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="https://homes.cs.washington.edu/~ali/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/ali-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Ali Farhadi <sup>1</sup></a></div>
						<div class="2u" style="font-size: 0.7em; line-height: 1.5em; text-align: center;"><a
								href="https://people.csail.mit.edu/ludwigs/"><span class="image fit"
									style="margin-bottom: 0.5em;"><img src="images/ludwig-thumbnail.png" alt=""
										style="border-radius: 50%;" /></span>Ludwig Schmidt <sup>1</sup></a></div>
					</div>
				</div>
			</section>
			<sup>1</sup> University of
			Washington&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<sup>2</sup> Columbia University&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<sup>3</sup> Google Research, Brain
			Team&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<div class="row" style="margin-top: 1em">
				<div class="12u$ 12u$(xsmall)">
					<h3>Bibtex</h3>
					<pre><code>@article {ilharco2022patching,
	title={Patching open-vocabulary models by interpolating weights},
	author={Ilharco, Gabriel and Wortsman, Mitchell and Gadre, Samir Yitzhak and Song, Shuran and Hajishirzi, Hannaneh and Kornblith, Simon and Farhadi, Ali and Schmidt, Ludwig},
	journal={arXiv},
	year={2022}
}</code>
							</pre>
				</div>
			</div>
			<!-- <hr / style="margin-top: 1em"> -->

			<!-- <div class="row">
				<div class="12u$ 12u$(xsmall)" style="text-align: center;">
					<h3>Technical Summary Video (with audio)</h3>
					<iframe width="640" height="360" src="https://www.youtube.com/embed/dNug1l-BcnM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
				</div>
			</div> -->

			<hr / style="margin-top: 1em">
			<h3>Acknowledgements</h3>
			<p> We thank Akari Asai, Alex Fang, Ari Holtzman, Pieter-Jan Kindermans, Marco Tulio Ribeiro, Ofir Press,
				Sarah Pratt, Sewon Min, Thao Nguyen and Tim Dettmers for helpful discussions and feedback, and Hyak at
				UW for computing support.
			</p>
			<hr / style="margin-top: 1em">
			<h3>Contact</h3>
			<p>If you have any questions, please contact <a href="https://gabrielilharco.com/">Gabriel</a>.</p>
			<hr />
		</section>
	</div>

	<!-- Footer -->
	<footer id="footer">
	</footer>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/jquery.poptrox.min.js"></script>
	<script src="assets/js/skel.min.js"></script>
	<script src="assets/js/util.js"></script>
	<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
	<script src="assets/js/main.js"></script>
</body>

</html>